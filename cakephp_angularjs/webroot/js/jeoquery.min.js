var jeoquery=function(c){var a={defaultData:{userName:"demo",lang:"en",country:"US"},defaultCountryCode:"US",defaultLanguage:"en",geoNamesApiServer:"api.geonames.org",geoNamesProtocol:"http",featureClass:{AdministrativeBoundary:"A",Hydrographic:"H",Area:"L",PopulatedPlace:"P",RoadRailroad:"R",Spot:"S",Hypsographic:"T",Undersea:"U",Vegetation:"V"},getGeoNames:function(b,d,g){var f=c.Deferred();if(!b||!e[b])throw'Invalid geonames method "'+b+'".';if(!d)throw"No parameters specified.";c.ajax({url:a.geoNamesProtocol+ "://"+a.geoNamesApiServer+"/"+b+"JSON",dataType:"jsonp",data:c.extend({},a.defaultData,d),success:function(a){f.resolve(a);g&&g(a)},error:function(a,b){f.reject(a,b);alert("Ooops, geonames server returned: "+b)}});return f.promise()}},e={astergdem:{params:["lat","lng"]},children:{params:["geonameId","maxRows"]},cities:{params:["north","south","east","west","lang"]},countryCode:{params:["lat","lng","type","lang","radius"]},countryInfo:{params:["country","lang"]},countrySubdivision:{params:["lat","lng", "level","lang","radius"]},earthquakes:{params:"north south east west date maxRows minMagnitude".split(" ")},findNearby:{params:"lat lng featureClass featureCode radius style maxRows".split(" ")},findNearbyPlacename:{params:["lat","lng","radius","style"]},findNearbyPostalCodes:{params:"lat lng radius style maxRows country localCountry postalCode".split(" ")},findNearbyStreets:{params:["lat","lng","radius","maxRows"]},findNearbyStreetsOSM:{params:["lat","lng"]},findNearbyWeather:{params:["lat","lng"]}, findNearbyWikipedia:{params:"lat lng radius maxRows country postalCode".split(" ")},findNearestAddress:{params:["lat","lng"]},findNearestIntersection:{params:["lat","lng"]},findNearestIntersectionOSM:{params:["lat","lng","radius","maxRows"]},findNearbyPOIsOSM:{params:["lat","lng"]},get:{params:["geonameId","lang","style"]},gtopo30:{params:["lat","lng"]},hierarchy:{params:["geonameId"]},neighbourhood:{params:["lat","lng"]},neighbours:{params:["geonameId","country"]},ocean:{params:["lat","lng","radius"]}, postalCodeCountryInfo:{params:[]},postalCodeLookup:{params:["postalcode","country","maxRows","charset"]},postalCodeSearch:{params:"postalcode postalcode_startsWith placename_startsWith country countryBias maxRows style operator charset isReduced".split(" ")},search:{params:"q name name_equals name_startsWith maxRows startRow country countryBias continentCode adminCode1 adminCode2 adminCode3 featureClass featureCode lang type style isNameRequired tag operator charset fuzzy".split(" ")},siblings:{params:["geonameId"]}, srtm3:{params:["lat","lng"]},timezone:{params:["lat","lng","radius","date"]},weather:{params:["north","south","east","west","maxRows"]},weatherIcao:{params:["ICAO"]},wikipediaBoundingBox:{params:"north south east west lang maxRows".split(" ")},wikipediaSearch:{params:["q","title","lang","maxRows"]}};return a}(jQuery); (function(c){c.fn.jeoCountrySelect=function(a){var e=this;c.when(jeoquery.getGeoNames("countryInfo")).then(function(b){var d=b.geonames;b.geonames.sort&&(d=b.geonames.sort(function(a,b){return a.countryName.localeCompare(b.countryName)}));d.unshift({countryCode:"",countryName:""});b=c.map(d,function(a){return'<option value="'+a.countryCode+'">'+a.countryName+"</option>"});e.html(b);a&&a.callback&&a.callback(d)})};c.fn.jeoPostalCodeLookup=function(a){this.on("change",function(){var e=c(this).val(), b=a.country||jeoquery.defaultCountryCode;a.countryInput&&(b=a.countryInput.val()||jeoquery.defaultCountry);e&&jeoquery.getGeoNames("postalCodeLookup",{postalcode:e,country:b},function(b){b&&b.postalcodes&&0<b.postalcodes.length&&a&&(a.target&&a.target.val(b.postalcodes[0].placeName),a.callback&&a.callback(b.postalcodes[0]))})})};c.fn.jeoCityAutoComplete=function(a){this.autocomplete({source:function(a,b){jeoquery.getGeoNames("search",{featureClass:jeoquery.featureClass.PopulatedPlace,style:"full", maxRows:12,name_startsWith:a.term},function(a){b(c.map(a.geonames,function(a){var b=a.name+(a.adminName1?", "+a.adminName1:"")+", "+a.countryName;return{label:b,value:b,details:a}}))})},minLength:2,select:function(c,b){b&&b.item&&a&&a.callback&&a.callback(b.item.details)},open:function(){c(this).removeClass("ui-corner-all").addClass("ui-corner-top")},close:function(){c(this).removeClass("ui-corner-top").addClass("ui-corner-all")}})}})(jQuery);